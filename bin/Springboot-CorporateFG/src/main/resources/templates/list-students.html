<!DOCTYPE html>
<html>
<meta charset="UTF-8">
<title>Student List</title>
<link rel="icon" href="images/fgimage.jpeg" type="image/jpeg">
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/bs4/dt-1.10.25/datatables.min.css" />
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/buttons/2.1.0/css/buttons.dataTables.min.css" />
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
	integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.5/dist/sweetalert2.min.css">
<link rel="stylesheet" href="/CSS Code/list-students.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css">
<link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.4.1/css/buttons.dataTables.min.css">

</head>
<style>
    .styled-link {
        display: inline-block;
        margin-right: 18px;
        font-weight: 600;
        color: #0d6efd;
        text-decoration: none;
        position: relative;
        padding-bottom: 3px;
        transition: color 0.3s ease;
    }

    .styled-link::after {
        content: '';
        position: absolute;
        left: 0;
        bottom: 0;
        width: 100%;
        height: 2px;
        background-color: #0d6efd;
        transform: scaleX(0);
        transform-origin: right;
        transition: transform 0.3s ease;
    }

    .styled-link:hover {
        color: #0a58ca;
    }

    .styled-link:hover::after {
        transform: scaleX(1);
        transform-origin: left;
    }

    .styled-link i {
        margin-right: 6px;
		}
#searchDiv{ display: none; margin-top: 1em; }
		    .message { color: green; margin-top: 1em; }
		 
			
			.count-card {
			    position: absolute;
			    top: 60px;
			    left: 200px;
			    padding: 12px 20px;
			    border: 1px solid #ccc;
			    border-radius: 10px;
			    background-color: #f9f9f9;
			    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
			    display: none;
			    z-index: 10;
			}
			.count-text {
			    font-size: 16px;
			    font-weight: bold;
			    text-align: center;
			}
			

</style>
<body>
	<div id="demo">
		<!-- âœ… Success Alert -->
		<div th:if="${placementSuccess}" class="alert alert-success alert-dismissible fade show position-fixed"
		     style="top: 20px; left: 50%; transform: translateX(-50%); z-index: 2000; width: 350px;" role="alert">
		  <strong th:text="${placementSuccess}"></strong>
		  <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
		</div>

		<!-- âŒ Error Alert -->
		<div th:if="${placementError}" class="alert alert-danger alert-dismissible fade show position-fixed"
		     style="top: 20px; left: 50%; transform: translateX(-50%); z-index: 2000; width: 350px;" role="alert">
		  <strong th:text="${placementError}"></strong>
		  <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
		</div>

	    <!--<h2>
	        List Students:&nbsp;
	        <i class="color-changing-text" style="font-size:25px;">Corporate FG-Infotech</i>
	        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
	        <span id="currentDateTime" style="font-size:15px; color:blue" th:text="${currentDateTime}">2025-03-29 12:00:00</span>
			 ğŸ§‘â€ğŸ’» Top Profile Section: ABOVE hr 
				    <div class="profile-container">
				        <div style="display: flex; align-items: center; justify-content: center; gap: 20px; margin-bottom: 15px;">
				            
				       <div style="text-align: center;">
							     ğŸ§‘â€ğŸ’¼ Stylish Login Text 
							    <div style="
							        font-size: 12px;
							        font-weight: 500;
							        color: #555;
							        font-family: 'Segoe UI', sans-serif;
							        margin-bottom: 4px;
							        letter-spacing: 0.3px;
							        text-transform: uppercase;
							    ">
							        ğŸ‘¤ Login as: <span style="color: #007bff;">Admin</span>
									 ğŸ–¼ï¸ Profile Image 
															    <img id="profileImagePreview" src="images/fgimage.jpeg"
															         style="width: 50px; height: 50px; border-radius: 4px; margin-bottom: 4px;" />
							    </div>
 </div>

				             ğŸ¢ FG Infotech Logo 
				            <div>
				                <img src="images/fgimage.jpeg"
				                     class="img-fluid profile-image"
				                     width="50px" height="50px"
				                     style="border-radius: 4px; cursor: pointer;"
				                     onclick="toggleUserInfo()" id="profileImage" />
				            </div>
				        </div>

				         ğŸ” Hover Info Box 
				        <div class="hover-box" id="userInfoBox" style="
				            display: none;
				            position: absolute;
				            right: 10px;
				            top: 60px;
				            background: #ffffff;
				            border: 1px solid #ddd;
				            border-radius: 12px;
				            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
				            padding: 16px 20px;
				            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
				            min-width: 220px;
				            z-index: 999;
				            animation: fadeIn 0.3s ease-in-out;">
				            
				            <div style="margin-bottom: 8px;">
				                ğŸ†” <strong>ID:</strong> <span th:text="${session.user.id}"></span>
				            </div>
				            <div style="margin-bottom: 8px;">
				                ğŸ” <strong>Login ID:</strong> <span th:text="${session.user.loginId}"></span>
				            </div>
				            <div style="margin-bottom: 8px;">
				                ğŸ‘¤ <strong>Username:</strong> <span th:text="${session.user.username}"></span>
				            </div>
				            <div style="margin-bottom: 12px;">
				                ğŸ•’ <strong>Login Time:</strong> <span th:text="${#temporals.format(session.user.loginAt, 'hh:mm a')}"></span>
				            </div>
				             ğŸšª Sign Out 
				            <a th:href="@{/logout}" style="
				                background-color: #dc3545;
				                color: white;
				                padding: 6px 14px;
				                border-radius: 8px;
				                text-decoration: none;
				                font-weight: bold;
				                transition: background 0.2s ease;"
				                onmouseover="this.style.backgroundColor='#c82333'" 
				                onmouseout="this.style.backgroundColor='#dc3545'">
				                Sign Out
				            </a>
				        </div>
				    </div>

		
		 </h2>
		 <hr style="margin-left: 40px; margin-right: 40px; margin-top: 10px; margin-bottom: 10px; border: none; height: 2px; background-color: #007bff;" />

-->

<!--<nav class="navbar navbar-expand-lg shadow-sm" 
     style="background: linear-gradient(to right, #f0f0f0, #ffffff); padding: 10px 40px; border-bottom: 3px solid #007bff;">
  <div class="container-fluid">

     ğŸ”– Title Section 
    <div>
      <div style="font-weight: 600; font-size: 16px; color: #000;">List Students</div>
      <div style="font-size: 18px; color: #007bff; font-weight: 500;">Corporate FG-Infotech</div>
    </div>

     ğŸ•’ Date Time (Right-Aligned) 
    <div class="d-none d-md-block ms-auto me-4">
      <span id="currentDateTime" style="font-size: 14px; color: #007bff;" th:text="${currentDateTime}">
        2025-03-29 12:00:00
      </span>
    </div>

     ğŸ‘¤ Profile & Logo Section 
    <div class="d-flex align-items-center gap-3">

       ğŸ‘¤ Admin Info 
      <div class="text-end" style="font-size: 12px;">
        <div style="color: #6c757d; text-transform: uppercase;">ğŸ‘¤ Login as:</div>
        <div style="color: #007bff; font-weight: 600;">Admin</div>
      </div>

       ğŸ§‘ Profile Image (60x60 Circle) 
      <div class="position-relative">
        <img id="profileImagePreview" src="images/fgimage.jpeg"
             class="rounded-circle border border-primary"
             style="width: 60px; height: 60px; object-fit: cover; cursor: pointer;" />
      </div>

       ğŸ¢ FG Infotech Logo (60x60 Square) 
      <div>
        <img src="images/fgimage.jpeg" width="60" height="60"
             class="border" style="cursor: pointer;" onclick="toggleUserInfo()" id="profileImage" />
      </div>

    </div>
  </div>
</nav>
-->
<nav class="navbar navbar-expand-lg shadow-sm" 
     style="background: linear-gradient(to right, #e3f2fd, #ffffff); padding: 10px 40px; border-bottom: 3px solid #007bff;">
  <div class="container-fluid">

    <!-- ğŸ”– Title Section -->
    <div>
      <div style="font-weight: 600; font-size: 16px; color: #000;">List Students</div>
      <div style="font-size: 18px; color: #007bff; font-weight: 500;">Corporate FG-Infotech</div>
    </div>

    <!-- ğŸ•’ Date Time (Right Shifted) -->
    <div class="d-none d-md-block ms-auto me-4">
      <span id="currentDateTime" style="font-size: 14px; color: #007bff;" th:text="${currentDateTime}">
        2025-03-29 12:00:00
      </span>
    </div>

    <!-- ğŸ‘¤ Profile & Logo Section -->
    <div class="d-flex align-items-center gap-3">

      <!-- ğŸ‘¤ Admin Info -->
      <div class="text-end" style="font-size: 12px;">
        <div style="color: #6c757d; text-transform: uppercase;">ğŸ‘¤ Login as:</div>
        <div style="color: #007bff; font-weight: 600;">Admin</div>
      </div>

      <!-- ğŸ§‘ Profile Image (60x60 Circle) -->
      <div class="position-relative">
        <img id="profileImagePreview" src="images/fgimage.jpeg"
             class="rounded-circle border border-primary"
             style="width: 60px; height: 60px; object-fit: cover; cursor: pointer;" />
      </div>

      <!-- ğŸ¢ FG Infotech Logo (60x60 Square) -->
      <div>
        <img src="images/fgimage.jpeg" width="60" height="60"
             class="rounded" style="cursor: pointer;" onclick="toggleUserInfo()" id="profileImage" />
      </div>

    </div>
  </div>
</nav>

<!-- ğŸ” Hover Info Box -->
<div class="hover-box" id="userInfoBox" style="
    display: none;
    position: absolute;
    right: 10px;
    top: 80px;
    background: #ffffff;
    border: 1px solid #ddd;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    padding: 16px 20px;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    min-width: 220px;
    z-index: 999;
    animation: fadeIn 0.3s ease-in-out;">
    
    <div style="margin-bottom: 8px;">
        ğŸ†” <strong>ID:</strong> <span th:text="${session.user.id}"></span>
    </div>
    <div style="margin-bottom: 8px;">
        ğŸ” <strong>Login ID:</strong> <span th:text="${session.user.loginId}"></span>
    </div>
    <div style="margin-bottom: 8px;">
        ğŸ‘¤ <strong>Username:</strong> <span th:text="${session.user.username}"></span>
    </div>
    <div style="margin-bottom: 12px;">
        ğŸ•’ <strong>Login Time:</strong> <span th:text="${#temporals.format(session.user.loginAt, 'hh:mm a')}"></span>
    </div>
    <!--<a th:href="@{/logout}" style="
        background-color: #dc3545;
        color: white;
        padding: 6px 14px;
        border-radius: 8px;
        text-decoration: none;
        font-weight: bold;
        transition: background 0.2s ease;"
        onmouseover="this.style.backgroundColor='#c82333'" 
        onmouseout="this.style.backgroundColor='#dc3545'">
        Sign Out
    </a>-->
	<a th:href="@{/dashboard}" style="
		    background-color: #0d6efd;
		    color: white;
		    padding: 6px 14px;
		    border-radius: 8px;
		    text-decoration: none;
		    font-weight: bold;
		    transition: background 0.2s ease;"
		    onmouseover="this.style.backgroundColor='#0b5ed7'" 
		    onmouseout="this.style.backgroundColor='#0d6efd'">
		    Dashboard
		</a>&nbsp;
	<a th:href="@{/logout}" style="
	    background-color: #dc3545;
	    color: white;
	    padding: 6px 14px;
	    border-radius: 8px;
	    text-decoration: none;
	    font-weight: bold;
	    margin-right: 10px;
	    transition: background 0.2s ease;"
	    onmouseover="this.style.backgroundColor='#c82333'" 
	    onmouseout="this.style.backgroundColor='#dc3545'">
	    Sign Out
	</a>
	
	<!--<a th:href="@{/logout}" class="styled-link">
	    <i class="bi bi-box-arrow-right"></i> Sign Out
	</a>

	<a th:href="@{/dashboard}" class="styled-link">
	    <i class="bi bi-speedometer2"></i> Dashboard
	</a>-->
</div>
<br />
<div class="icon-container">
			<a href="/addStudentForm" class="icon-button add-student" title="Add Student">
				<i class="fas fa-user-plus"></i>
			</a>
			<a href="#" id="logoutBtn" class="icon-button logout" title="Logout">
				<i class="fas fa-sign-out-alt"></i>
			</a>
						<a href="https://wa.me/919511200293" target="_blank" title="Open WhatsApp Chat">
						    <img src="https://cdn-icons-png.flaticon.com/512/733/733585.png"
						         alt="WhatsApp" style="width:40px;height:40px;cursor:pointer;">
						</a>&nbsp;
			<div style="position: relative;">
				<a href="#" id="notificationBtn" class="icon-button" title="Notifications"
					style="background-color:#007bff;">
					<i class="fas fa-bell"></i>
					<span id="notificationCount" style="
          position: absolute;
          top: -5px;
          right: -5px;
		 text-align: right;
          background: red;
          color: white;
          font-size: 12px;
          font-weight: bold;
          padding: 2px 6px;
          border-radius: 50%;
          display: none;
        ">0</span>
				</a>
			</div>
		
			
				
			<div style="position: relative; display: inline-block;" id="settingsWrapper">
			    <a href="javascript:void(0);" onclick="toggleUploadDropdown()"
			       title="Settings"
			       style="
			           background-color: #343a40; /* Real-time dark gray */
			           color: white;
			           border-radius: 50%;
			           padding: 10px;
			           font-size: 14px;
			           display: inline-flex;
			           align-items: center;
			           justify-content: center;
			           width: 40px;
			           height: 40px;
			           text-decoration: none;
			           box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
			           transition: background-color 0.2s ease-in-out;
			       "
			       onmouseover="this.style.backgroundColor='#212529'"
			       onmouseout="this.style.backgroundColor='#343a40'">
			        <i class="fas fa-cog"></i>
			    </a>
				<!-- Admin Email (positioned to the far right) -->
				
				<span style="
				    position: fixed;
				    right: 40px;
				    
				    font-size: 14px;
				    font-weight: 500;
				    color: black;">
				    Login Email As: 
				    <span th:text="${session.user.email}" style="color: #007bff;"></span>
				</span>

				<!-- Admin Email (positioned to the far right) -->
    <div id="uploadLinkContainer" style="
			        display: none;
			        position: absolute;
			        top: 45px;
			        right: 0;
			        background-color: #fff;
			        border: 1px solid #ddd;
			        border-radius: 10px;
			        padding: 8px 0;
			        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
			        width: 200px;
			        font-family: 'Segoe UI', sans-serif;
			        z-index: 999;
			    ">
			     <a href="javascript:void(0);" onclick="document.getElementById('profileUpload').click()"
			           style="display: block; padding: 8px 16px; text-decoration: none; color: #007bff;"
			           onmouseover="this.style.backgroundColor='#f0f8ff'"
			           onmouseout="this.style.backgroundColor='transparent'">
			            ğŸ“¤ Upload Profile
			        </a>
			        <input type="file" id="profileUpload" accept="image/*" style="display: none;" onchange="previewAndSaveProfile()" />
					
					<!--<a href="javascript:void(0);" style="display: block; padding: 8px 16px; text-decoration: none; color: #333;"
					   onmouseover="this.style.backgroundColor='#f0f8ff'"
					   onmouseout="this.style.backgroundColor='transparent'">ğŸ“œ History</a>
-->

<a href="javascript:void(0);" id="historyBtn" class="history-btn"
   style="display: block; padding: 8px 16px; text-decoration: none; color: #007bff;"
   onmouseover="this.style.backgroundColor='#f0f8ff'"
   onmouseout="this.style.backgroundColor='transparent'">
   ğŸ‘¥ Admins History
</a>

<!-- ğŸ§¾ Stylish History Card -->
<div id="historyCard" class="card shadow"
     style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 500px;
            max-height: 80vh;  /* Limits height to 80% of viewport */
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: #ecf0f1;
            z-index: 1000;
            border-radius: 16px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
            overflow: hidden;">
    <div class="card-body" style="max-height: 70vh; overflow-y: auto; padding-right: 12px;">
        <h5 class="card-title text-center mb-4" style="color: #ffc107; font-weight: bold; letter-spacing: 1px;">
            ğŸ‘¥ Admin Login History
        </h5>
        <div id="adminGroupedTable">
            <!-- Table dynamically inserted here -->
        </div>
    </div>
</div>



				
				<!--	<a href="javascript:void(0);" style="display: block; padding: 8px 16px; text-decoration: none; color: #333;"
					   onmouseover="this.style.backgroundColor='#f0f8ff'"
					   onmouseout="this.style.backgroundColor='transparent'">ğŸ§© Roles</a>
-->
<a href="javascript:void(0);" id="rolesBtn"
   style="display: block; padding: 8px 16px; text-decoration: none; color: #333;"
   onmouseover="this.style.backgroundColor='#f0f8ff'"
   onmouseout="this.style.backgroundColor='transparent'">
   ğŸ§© Roles
</a>
<!-- ğŸ” Roles Card -->
<div id="rolesCard" class="card shadow-lg border-0"
     style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 100%; max-width: 400px; z-index: 1050;">
  <div class="card-body rounded-3 text-white"
       style="background: linear-gradient(135deg, #2e3b4e, #3f4e64);">
    
    <h5 class="card-title text-center mb-3 text-warning fw-bold">
      ğŸ” Role Access Info
    </h5>

    <ul class="list-unstyled mb-0">
      <li><strong>FG01:</strong> All Access</li>
      <li><strong>Others:</strong> All Access excluding
        <span class="text-danger">Update</span> and
        <span class="text-danger">Delete</span>
      </li>
    </ul>
  </div>
</div>

				
				<!--	<a href="javascript:void(0);" style="display: block; padding: 8px 16px; text-decoration: none; color: #333;"
					   onmouseover="this.style.backgroundColor='#f0f8ff'"
					   onmouseout="this.style.backgroundColor='transparent'">ğŸ‘¨â€ğŸ’¼ Admins</a>

					-->
					<!--<a href="javascript:void(0);" style="display: block; padding: 8px 16px; text-decoration: none; color: #333;"
					   onmouseover="this.style.backgroundColor='#f0f8ff'"
					   onmouseout="this.style.backgroundColor='transparent'">ğŸ“ Students</a>
				   -->
				   
				   <a href="javascript:void(0);" id="studentsBtn"
				      style="display: block; padding: 8px 16px; text-decoration: none; color: #333;"
				      onmouseover="this.style.backgroundColor='#f0f8ff'"
				      onmouseout="this.style.backgroundColor='transparent'">
				      ğŸ“ Students
				   </a>
				   <div id="studentsCard" class="card shadow-lg border-0"
				        style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
				               width: 280px; z-index: 1050;">
				     <div class="card-body rounded-3 text-center text-white"
				          style="background: linear-gradient(135deg, #2e7d32, #388e3c);">
				       <h4 class="mb-2">ğŸ“ Total Students</h4>
				       <h1 id="studentCount" class="fw-bold display-6 text-warning">0</h1>
				     </div>
				   </div>

				   <a href="javascript:void(0);" id="fourBtn"
				      style="display: block; padding: 8px 16px; text-decoration: none; color: #007bff;"
				      onmouseover="this.style.backgroundColor='#e3f2fd'"
				      onmouseout="this.style.backgroundColor='transparent'">
				      ğŸ’° Four Count List
				   </a>

				   <!-- ğŸ’° Four Count Card -->
				   <div id="fourCard" class="card shadow-lg border-0"
				        style="display: none; position: fixed; top: 52%; left: 50%; transform: translate(-50%, -50%);
				               width: 260px; z-index: 1060;">
				     <div class="card-body bg-info text-center text-white rounded-3">
				       <h5 class="mb-2">ğŸ’° Paid Fees 40000</h5>
				       <h2 id="fourCount" class="fw-bold text-warning">0</h2>
				     </div>
				   </div>
				   <a href="javascript:void(0);" id="fourFiveBtn"
				      style="display: block; padding: 8px 16px; text-decoration: none; color: #28a745;"
				      onmouseover="this.style.backgroundColor='#e8f5e9'"
				      onmouseout="this.style.backgroundColor='transparent'">
				      ğŸ’³ Four Five Count List
				   </a>

				   <!-- ğŸ’³ Four Five Count Card -->
				   <div id="fourFiveCard" class="card shadow-lg border-0"
				        style="display: none; position: fixed; top: 52%; left: 50%; transform: translate(-50%, -50%);
				               width: 260px; z-index: 1060;">
				     <div class="card-body bg-success text-center text-white rounded-3">
				       <h5 class="mb-2">ğŸ’³ Paid Fees 45000</h5>
				       <h2 id="fourFiveCount" class="fw-bold text-warning">0</h2>
				     </div>
				   </div>

					<!--<a href="javascript:void(0);" style="display: block; padding: 8px 16px; text-decoration: none; color: #b22222;"
					   onmouseover="this.style.backgroundColor='#fff3f3'"
					   onmouseout="this.style.backgroundColor='transparent'">ğŸ¯ Unpaid Scholarship</a>
-->
					
<a href="javascript:void(0);" id="unpaidBtn"
   style="display: block; padding: 8px 16px; text-decoration: none; color: #b22222;"
   onmouseover="this.style.backgroundColor='#fff3f3'"
   onmouseout="this.style.backgroundColor='transparent'">
   ğŸ¯ Unpaid Scholarship
</a>
<div id="unpaidCard" class="card shadow-lg border-0"
     style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 300px; z-index: 1050;">
  <div class="card-body text-center text-white rounded-3"
       style="background: linear-gradient(135deg, #8e0e00, #1f1c18);">
    <h4 class="mb-3 text-warning">ğŸ¯ Unpaid Scholarship</h4>
    <h1 id="unpaidCount" class="display-5 fw-bold text-danger">0</h1>
  </div>
</div> 


					<!--<a href="javascript:void(0);" style="display: block; padding: 8px 16px; text-decoration: none; color: #007bff;"
					   onmouseover="this.style.backgroundColor='#eef7ff'"
					   onmouseout="this.style.backgroundColor='transparent'">âš™ï¸ Admin Settings</a>
-->

<!--<button onclick="showSearch()">Mark Placement</button>
<div id="searchDiv">
    <form th:action="@{/placeStudent}" method="post">
      <input type="text" name="name" placeholder="Student name" required />
      <button type="submit">Submit</button>
    </form>
  </div>

  <div th:if="${message}" class="message" th:text="${message}"></div>
  -->
 
  <!-- Mark Placement Button -->
 <!-- <a href="javascript:void(0);" id="markPlacementBtn"
     style="display: block; padding: 8px 16px; text-decoration: none; color: #0b3d91;"
     onmouseover="this.style.backgroundColor='#e8f0fe'"
     onmouseout="this.style.backgroundColor='transparent'">
     ğŸ† Mark Placement
  </a>

   Mark Placement Card 
  <div id="placementCard" class="card shadow-lg border-0"
       style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
              width: 350px; z-index: 1050;">
    <div class="card-body text-center text-white rounded-3"
         style="background: linear-gradient(135deg, #007991, #78ffd6);">
      <h4 class="mb-3 text-dark fw-bold">ğŸ† Mark Placement</h4>
      
       Form 
      <form th:action="@{/placeStudent}" method="post">
        <input type="text" name="name" placeholder="Enter student name" required
               style="padding: 8px; width: 80%; border-radius: 8px; border: none;" />
        <br><br>
        <button type="submit" style="padding: 8px 16px; border: none; border-radius: 8px;
                background-color: #0b3d91; color: white;">Submit</button>
      </form>
      
       Optional Close Button 
      <button onclick="hidePlacementCard()" style="margin-top: 10px; background: none; border: none; color: #fff;">
        âŒ Close
      </button>
    </div>
  </div>

 
   âœ… Simple text alert 
  <div th:if="${message}" style="background-color: #e7f3fe; color: #0c5460; padding: 10px; border-left: 6px solid #2196F3; margin: 20px auto; max-width: 500px; text-align: center; font-weight: bold;">
      <span th:text="${message}">This is a message</span>
  </div>
   ğŸŒŸ Stylish Centered Alert 
  <div id="customAlert" th:if="${message}"
       style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
              background: linear-gradient(135deg, #dff9fb, #c7ecee);
              color: #130f40; padding: 20px 30px;
              border-left: 6px solid #00a8ff;
              border-radius: 10px; font-size: 1.2rem;
              font-weight: bold; z-index: 9999;
              box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
              text-align: center; display: flex; align-items: center; gap: 15px;
              opacity: 1; transition: opacity 0.5s ease;">
      
       Message 
      <span th:text="${message}">This is a message</span>

       âŒ Close Button 
      <button onclick="closeCustomAlert()"
              style="background: none; border: none; font-size: 24px; color: #130f40; font-weight: bold; cursor: pointer; margin-left: auto;">
          &times;
      </button>
  </div>
-->
  <!--END-->
  
  <!--START HERE-->
  <!-- ğŸŒŸ Mark Placement Button -->
  <a href="javascript:void(0);" id="markPlacementBtn"
     style="display: block; padding: 8px 16px; text-decoration: none; color: #0b3d91;"
     onmouseover="this.style.backgroundColor='#e8f0fe'"
     onmouseout="this.style.backgroundColor='transparent'">
     ğŸ† Mark Placement
  </a>

  <a href="javascript:void(0);" id="placedStudentsBtn" class="placement-btn"
     style="display: block; padding: 8px 16px; text-decoration: none; color: #007bff;"
     onmouseover="this.style.backgroundColor='#f0f8ff'"
     onmouseout="this.style.backgroundColor='transparent'">
     ğŸ“ Placed Students
  </a>

  <!--<a th:href="@{/sendInternship}">
      <button style="background-color:#006699;color:white;padding:10px 20px;border:none;border-radius:5px;">
          Send Internship Certificate
      </button>
  </a>
-->

<!-- Internship Certificate Button -->
<div th:if="${session.user?.loginId == 'FG01'}">
<a th:href="@{/sendInternship}" id="internshipCertBtn" class="placement-btn"
   style="display: block; padding: 8px 16px; text-decoration: none; color: #007bff;"
   onmouseover="this.style.backgroundColor='#f0f8ff'"
   onmouseout="this.style.backgroundColor='transparent'">
   ğŸ“„ Send Intern Cert
</a>
<!-- Course Completion Certificate Button -->
<a th:href="@{/sendCourseCompletion}" id="courseCertBtn" class="placement-btn"
   style="display: block; padding: 8px 16px; text-decoration: none; color: #28a745;"
   onmouseover="this.style.backgroundColor='#e6ffee'"
   onmouseout="this.style.backgroundColor='transparent'">
   ğŸ“ Send Course Cert
</a>
<a th:href="@{/send-receipt/form}" id="feesReceiptBtn" class="placement-btn"
   style="display: inline-block; padding: 8px 16px; text-decoration: none; color: #007bff;"
   onmouseover="this.style.backgroundColor='#e6f0ff'"
   onmouseout="this.style.backgroundColor='transparent'">
   ğŸ“© Send Fees Receipt
</a>
</div>
  <!-- ğŸ’  Mark Placement Form Card -->
  <div id="placementCard" class="card shadow-lg border-0"
       style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
              width: 350px; z-index: 1050;">
    <div class="card-body text-center text-white rounded-3"
         style="background: linear-gradient(135deg, #007991, #78ffd6);">
      <h4 class="mb-3 text-dark fw-bold">ğŸ† Mark Placement</h4>

      <!-- Placement Form -->
      <form th:action="@{/placeStudent}" method="post">
        <input type="text" name="name" placeholder="Enter student name" required
               style="padding: 8px; width: 80%; border-radius: 8px; border: none;" />
        <br><br>
        <button type="submit" style="padding: 8px 16px; border: none; border-radius: 8px;
                background-color: #0b3d91; color: white;">Submit</button>
      </form>

      <!-- Close Button -->
      <button onclick="hidePlacementCard()" style="margin-top: 10px; background: none; border: none; color: #fff;">
        âŒ Close
      </button>
    </div>
  </div>

<!-- Placement Students Table Card -->
<!--<div id="placementStudentsCard" class="card shadow-lg border-0"
     style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 700px; max-height: 400px; overflow-y: auto; z-index: 1050;">
  <div class="card-body text-center text-white rounded-3"
       style="background: linear-gradient(135deg, #283c86, #45a247);">
    <h4 class="mb-3 text-dark fw-bold">ğŸ“ Placed Students List</h4>

    <div class="table-responsive">
      <table class="table table-striped table-bordered bg-white text-dark">
        <thead class="table-success text-center">
          <tr>
            <th>Name</th>
            <th>Batch No</th>
            <th>Mobile No</th>
            <th>Course</th>
          </tr>
        </thead>
        <tbody id="placedStudentsTableBody">
           Filled dynamically 
        </tbody>
      </table>
    </div>

    <button onclick="$('#placementStudentsCard').fadeOut();"
            style="margin-top: 10px; background: none; border: none; color: #fff;">
      âŒ Close
    </button>
  </div>
</div>-->
<!-- ğŸ“â€¯Placedâ€¯Studentsâ€¯Cardâ€¯(with search + vertical scrollbar) -->
<div id="placementStudentsCard" class="card shadow-lg border-0"
     style="display:none;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);
            width:700px;z-index:1050;">
  <div class="card-body text-center text-white rounded-3"
       style="background:linear-gradient(135deg,#283c86,#45a247);">
    <h4 class="text-dark fw-bold mb-3">ğŸ“Â PlacedÂ Students List</h4>

    <!-- ğŸ”Â Search input -->
    <input type="text" id="studentSearch" class="form-control mb-2"
           placeholder="Type student nameâ€¦">

    <!-- ğŸ“‹Â Table wrapper with maxâ€‘height & scrollbar -->
    <div class="table-responsive" style="max-height:192px;overflow-y:auto;">
      <table class="table table-striped table-bordered bg-white text-dark mb-0">
        <thead class="table-success text-center sticky-top">
          <tr>
            <th>Name</th>
            <th>BatchÂ No</th>
            <th>MobileÂ No</th>
            <th>Course</th>
          </tr>
        </thead>
        <tbody id="placedStudentsTableBody"><!-- filled via Ajax --></tbody>
      </table>
    </div>

    <button class="btn btn-sm btn-light mt-3" onclick="$('#placementStudentsCard').fadeOut();">
      âŒÂ Close
    </button>
  </div>
</div>
  <!-- ğŸŒŸ Custom Alert -->
 <!-- <div id="customAlert" th:if="${message}"
       style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
              background: linear-gradient(135deg, #ffeaa7, #fab1a0); color: #2d3436;
              padding: 20px 30px; border-left: 6px solid #d63031; border-radius: 10px;
              font-size: 1.2rem; font-weight: bold; z-index: 9999;
              box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
              display: flex; align-items: center; gap: 15px; opacity: 1;
              transition: opacity 0.5s ease;">
    <span th:text="${message}">This is a message</span>
    <button onclick="closeCustomAlert()"
            style="background: none; border: none; font-size: 24px; color: #2d3436;
                   font-weight: bold; cursor: pointer; margin-left: auto;">&times;</button>
  </div>-->


  <!--END HERE--->
  
  <!-- âœ… Success Alert -->
  <!--<div th:if="${placementSuccess}" class="alert alert-success alert-dismissible fade show position-fixed"
       style="top: 20px; left: 50%; transform: translateX(-50%); z-index: 2000; width: 350px;" role="alert">
    <strong th:text="${placementSuccess}"></strong>
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
  </div>

   âŒ Error Alert 
  <div th:if="${placementError}" class="alert alert-danger alert-dismissible fade show position-fixed"
       style="top: 20px; left: 50%; transform: translateX(-50%); z-index: 2000; width: 350px;" role="alert">
    <strong th:text="${placementError}"></strong>
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
  </div>
-->
  <!---->

			    </div>
			</div>
</div>



		<table border="1" class="table table-bordered table-striped" id="student-table">
			<thead>
				<tr>
					<th>Name</th>
					<th>Email</th>
					<th>Mobile</th>
					<th>Batch</th>
					<th>DOA</th>
					<th th:style="'display: none;'">TFess</th>
					<th th:style="'display: none;'">RFees</th>
					<th th:style="'display: none;'">PFees</th>
					<th>CreatedBy</th>
					<th>ModifiedBy</th>
					<th>Course</th>
					<th th:style="'display: none;'">Comments</th>
					<th>Qualification</th>
					<th th:style="'display: none;'">CreatedOn</th>
					<th th:style="'display: none;'">UpdatedOn</th>
					<th th:style="'display: none;'">Placed</th>
					<th>Action</th>
				</tr>
			</thead>
			<tbody>
				<tr th:each="student : ${students}">
					<td th:text="${student.name}"></td>
					<td th:text="${student.email}"></td>
					<td th:text="${student.mobile}"></td>
					<td th:text="${student.batchNo}"></td>
					<td th:text="${student.admissionDate}"></td>
					<td th:text="'45000'" th:style="'display: none;'"></td>
					<td th:text="${student.paidFees}" th:style="'display: none;'"></td>
					<td th:text="${45000 - student.paidFees}" th:style="'display: none;'"></td>
					<td th:text="${student.createdBy}"></td>
					<td th:text="${student.modifiedBy}"></td>
					<td th:text="${student.course}"></td>
					<td th:text="${student.comments}" th:style="'display: none;'"></td>
					<td th:text="${student.highestQualification}"></td>
					<td th:text="${student.createdOn}" th:style="'display: none;'"></td>
					<td th:text="${student.updatedOn}" th:style="'display: none;'"></td>
					<td th:text="${student.placed}" th:style="'display: none;'"></td> <!-- hidden value -->
					<td>
						<div class="dropdown">
							<button class="btn btn-light border-0 shadow-sm" type="button" id="dropdownMenuButton"
								data-bs-toggle="dropdown" aria-expanded="false"
								style="padding: 6px 10px; border-radius: 8px; background-color: #f0f0f0;">
								<i class="fas fa-bars" style="font-size: 18px; color: #007bff;"></i>
							</button>
							<!-- Hidden Field to Hold loginId -->
							<input type="hidden" id="loginId" th:value="${session.user?.loginId}" />

							<ul class="dropdown-menu dropdown-menu-end shadow" aria-labelledby="dropdownMenuButton"
							    style="min-width: 160px; border-radius: 8px;">
							    
							    <!-- Always show view -->
							    <li>
							        <a class="dropdown-item d-flex align-items-center"
							           th:href="@{/ShowStudentSecureData(studentId=${student.id})}">
							            <i class="fas fa-eye text-primary me-2"></i>
							            <span>View</span>
							        </a>
							    </li>

								<!-- Update Button only for FG01 -->
								<li th:if="${session.user?.loginId == 'FG01'}">
								    <a class="dropdown-item d-flex align-items-center"
								       th:href="@{/showUpdateForm(studentId=${student.id})}">
								        <i class="fas fa-pen text-warning me-2"></i>
								        <span>Update</span>
								    </a>
								</li>
								<li th:unless="${session.user?.loginId == 'FG01'}">
								    <a class="dropdown-item d-flex align-items-center disabled-link" href="javascript:void(0);">
								       <i class="fas fa-ban text-danger me-2"></i>
								        <span class="text-muted">Update</span>
								    </a>
								</li>
							<!-- Delete Button only for FG01 -->
								<li th:if="${session.user?.loginId == 'FG01'}">
								    <a class="dropdown-item d-flex align-items-center text-danger"
								       href="javascript:void(0);" th:onclick="|confirmDelete(${student.id})|">
								        <i class="fas fa-trash-alt me-2"></i>
								        <span>Delete</span>
								    </a>
								</li>
								<li th:unless="${session.user?.loginId == 'FG01'}">
								    <a class="dropdown-item d-flex align-items-center disabled-link" href="javascript:void(0);">
								       <i class="fas fa-ban text-danger me-2"></i>
								        <span class="text-muted">Delete</span>
								    </a>
								</li>
							</ul>
						</div>
					</td>
				</tr>
			</tbody>
		</table>
	</div>
	<div class="modal fade" id="logoutModal" tabindex="-1" aria-labelledby="logoutModalLabel" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="logoutModalLabel">Confirm Logout</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body">
					Are you sure you want to logout?
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-danger" id="confirmLogoutBtn">Logout</button>
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
				</div>
			</div>
		</div>
	</div>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script src="https://cdn.datatables.net/v/bs4/dt-1.10.25/datatables.min.js"></script>
	<script src="https://cdn.datatables.net/buttons/2.1.0/js/dataTables.buttons.min.js"></script>
	<script src="https://cdn.datatables.net/buttons/2.1.0/js/buttons.html5.min.js"></script>
	<script src="https://cdn.datatables.net/buttons/2.1.0/js/buttons.print.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.70/pdfmake.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.70/vfs_fonts.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.5/dist/sweetalert2.all.min.js"></script>
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	<script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
	<script src="https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js"></script>
	<script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js"></script>
	<script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.print.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/pdfmake.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/vfs_fonts.js"></script>
	<script>
		document.getElementById('logoutBtn').addEventListener('click', function (e) {
			e.preventDefault();
			$('#logoutModal').modal('show');
		});
		document.getElementById('confirmLogoutBtn').addEventListener('click', function () {
		    window.location.href = '/logout';
		});

	</script>

	
	<script>
	    $(document).ready(function () {
	        $(".history-btn").click(function () {
				hideAllCards(); 
	            $.ajax({
	                url: "/getAllAdmins",
	                method: "GET",
	                success: function (data) {
	                    let groupedData = {};

	                    // Group by loginId (like FG01, FG02)
	                    data.forEach(function (admin) {
	                        if (!groupedData[admin.loginId]) {
	                            groupedData[admin.loginId] = [];
	                        }
	                        groupedData[admin.loginId].push(admin);
	                    });

	                    // Create table per group
	                    let content = "";
	                    for (const loginId in groupedData) {
	                        content += `
	                            <h6 style="background-color: #444; padding: 8px 10px; border-radius: 6px; margin-top: 20px;">
	                                ğŸ” Admin: <span style="color:#17a2b8;">${loginId}</span>
	                            </h6>
	                            <div class="table-responsive">
	                                <table class="table table-sm table-bordered table-dark mt-2">
	                                    <thead class="thead-light">
	                                        <tr>
	                                            <th>ID</th>
	                                            <th>Username</th>
											    <th>isLogin</th>
	                                            <th>Login At</th>
	                                            <th>Logout At</th>
												<th>Login Ip</th>
	                                        </tr>
	                                    </thead>
	                                    <tbody>`;

											groupedData[loginId].forEach(admin => {
											    content += `
											        <tr>
											            <td>${admin.id}</td>
											            <td>${admin.username}</td>
											            <td>${admin.login ? 'âœ… Yes' : 'âŒ No'}</td>
											            <td>${formatDateTime(admin.loginAt)}</td>
											            <td>${formatDateTime(admin.logoutAt)}</td>
											            <td>${admin.loginIp}</td>
											        </tr>`;
											});
	                        //});

	                        content += `</tbody></table></div>`;
	                    }

	                    $("#adminGroupedTable").html(content);
	                    $("#historyCard").fadeIn();
	                },
	                error: function () {
	                    alert("âŒ Failed to load admin history");
	                }
	            });
	        });
	    });
	</script>
<script>
	function formatDateTime(dateStr) {
	  if (!dateStr) return '-';
	  const date = new Date(dateStr);
	  if (isNaN(date)) return '-';
	  return date.toLocaleString('en-IN', {
	    hour: 'numeric',
	    minute: 'numeric',
	    hour12: true,
	    day: '2-digit',
	    month: 'short',
	    year: 'numeric'
	  });
	}

	</script>
	
	<script>
		$(document).ready(function () {
			$('#student-table').DataTable({
				dom: 'Bfrtip',
				    pageLength: 5,
					lengthMenu: [ [5, 10, 25, 50, -1], [5, 10, 25, 50, "All"] ],
				    columnDefs: [
				      { orderable: true, targets: [0, 1] },
				      { orderable: false, targets: '_all' } 
				    ],
					buttons: [
					  'copyHtml5',
					  'excelHtml5',
					  'csvHtml5',
					  {
					    extend: 'pdfHtml5',
					    text: 'N PDF',
					    orientation: 'landscape',
					    pageSize: 'A4',
					    exportOptions: {
					      columns: function (idx, data, node) {
					        var totalColumns = $('#student-table').DataTable().columns().nodes().length;
					        return $(node).is(':visible') && idx !== (totalColumns - 1);
					      }
					    },
					    customize: function (doc) {
					      doc['header'] = function () {
					        return {
					          columns: [
					            { text: 'FG Infotech', alignment: 'right', fontSize: 14, bold: true, color: '#1a73e8' }
					          ],
					          margin: [10, 10]
					        };
					      };
					      doc.content[1].layout = {
					        hLineWidth: function () { return 0.5; },
					        vLineWidth: function () { return 0.5; },
					        hLineColor: function () { return '#aaa'; },
					        vLineColor: function () { return '#aaa'; },
					        paddingLeft: function () { return 8; },
					        paddingRight: function () { return 8; },
					        paddingTop: function () { return 4; },
					        paddingBottom: function () { return 4; }
					      };
					      doc.defaultStyle.fontSize = 10;
					    }
					  },
					  {
					    extend: 'pdfHtml5',
					    text: 'PL PDF',
					    orientation: 'landscape',
					    pageSize: 'A4',
					    exportOptions: {
					      columns: [0,1,2,3,4,5,6,7,8,9,10,15], // exclude the hidden column from export
					      rows: function (idx, data, node) {
					        return data[15] === 'true'; // 8 is index of hidden placed column
					      }
					    },
					    customize: function (doc) {
					      doc['header'] = function () {
					        return {
					          columns: [
					            { text: 'FG Infotech â€” Placed Students Report', alignment: 'center', fontSize: 16, bold: true, color: '#2e86de' }
					          ],
					          margin: [0, 10]
					        };
					      };
					      doc.content[1].layout = {
					        hLineWidth: function () { return 0.8; },
					        vLineWidth: function () { return 0.8; },
					        hLineColor: function () { return '#2c3e50'; },
					        vLineColor: function () { return '#2c3e50'; },
					        paddingLeft: function () { return 6; },
					        paddingRight: function () { return 6; },
					        paddingTop: function () { return 5; },
					        paddingBottom: function () { return 5; }
					      };
					      doc.defaultStyle = {
					        fontSize: 10,
					        color: '#2d3436'
					      };
					      doc.styles.tableHeader = {
					        fillColor: '#00cec9',
					        color: 'black',
					        fontSize: 12,
					        bold: true,
					        alignment: 'center'
					      };
					      doc.pageMargins = [20, 40, 20, 30];
					    }
					  },

					  {
					    extend: 'pdfHtml5',
					    text: 'S PDF',
					    orientation: 'landscape',
					    pageSize: 'A4',
					    exportOptions: {
					      columns: function (idx, data, node) {
					        return true; // We'll control columns manually in customize
					      }
					    },
					    customize: function (doc) {
					      const table = $('#student-table').DataTable();

					      const allData = table.rows({ search: 'applied' }).data();
					      const visibleColumns = table.columns(':visible').indexes().toArray();
					      const hiddenColumns = table.columns(':hidden').indexes().toArray();

					      // Indexes of columns we want
					      const studentNameColIndex = visibleColumns.find(i =>
					        $(table.column(i).header()).text().trim().toLowerCase().includes('name')
					      );

					      const studentMobileColIndex = visibleColumns.find(i =>
					        $(table.column(i).header()).text().trim().toLowerCase().includes('mobile')
					      );

						  const exportIndexes = [
						    studentNameColIndex,
						    studentMobileColIndex,
						    ...hiddenColumns.filter(idx => idx !== 15) // Exclude Placed column (index 15)
						  ];

					      const headerRow = exportIndexes.map(idx => ({
					        text: $(table.column(idx).header()).text().trim(),
					        style: 'tableHeader'
					      }));

					      const body = [headerRow];

					      for (let i = 0; i < allData.length; i++) {
					        const row = [];
					        exportIndexes.forEach(idx => {
					          row.push(allData[i][idx]);
					        });
					        body.push(row);
					      }

					      // Replace body in the PDF
					      doc.content[1].table.body = body;

					      // Add custom header
					      doc['header'] = function () {
					        return {
					          columns: [
					            {
					              text: 'Security Data - FG Infotech',
					              alignment: 'right',
					              fontSize: 8,
					              bold: true,
					              color: '#d32f2f'
					            }
					          ],
					          margin: [10, 10]
					        };
					      };

					      // Styling
					      doc.styles.tableHeader = {
					        fillColor: '#d32f2f',
					        color: 'white',
					        bold: true
					      };
					      doc.styles.tableBodyEven = { fillColor: '#fce4ec' };
					      doc.styles.tableBodyOdd = { fillColor: '#ffffff' };
					      doc.defaultStyle.fontSize = 8;

					      doc.content[1].layout = {
					        hLineWidth: function () { return 0.5; },
					        vLineWidth: function () { return 0.5; },
					        hLineColor: function () { return '#aaa'; },
					        vLineColor: function () { return '#aaa'; },
					        paddingLeft: function () { return 4; },
					        paddingRight: function () { return 4; },
					        paddingTop: function () { return 2; },
					        paddingBottom: function () { return 2; }
					      };

					      // Auto-adjust widths
					      doc.content[1].table.widths = Array(body[0].length).fill('*');
					    }
					  },


					  'print'
					]

			});

			let count = 0;
			$('#student-table tbody tr').each(function () {
				let paidFeesText = $(this).find('td').eq(6).text().trim();
				let paidFees = parseFloat(paidFeesText);
				if (!isNaN(paidFees) && paidFees < 5000) {
					count++;
				}
			});

			if (count > 0) {
				$('#notificationCount').text(count).addClass('show');
			}

			$('#notificationBtn').click(function (e) {
				e.preventDefault();
				Swal.fire({
					icon: 'info',
					title: 'Recevied Fees',
					text: `There are ${count} students with Recevied fees less than 5000.`,
				});
			});

		});
	</script>
	<script>
		function confirmDelete(studentId) {
			Swal.fire({
				title: 'Are you sure?',
				text: "You won't be able to revert this!",
				icon: 'warning',
				showCancelButton: true,
				confirmButtonText: 'Yes, delete it!',
				cancelButtonText: 'No, cancel!',
				reverseButtons: true
			}).then((result) => {
				if (result.isConfirmed) {
					window.location.href = `/deleteStudent?studentId=${studentId}`;
					showAlert();
				} else if (result.dismiss === Swal.DismissReason.cancel) {
					Swal.fire(
						'Cancelled',
						'The student was not deleted.',
						'error'
					);
				}
			});
		}

		function showAlert() {
			Swal.fire(
				'Deleted!',
				'The record has been deleted successfully.',
				'success'
			);
		}


	</script>
	<!--<script>
			let timer;
			function resetTimer() {
				clearTimeout(timer);
				timer = setTimeout(() => {
					window.location.href = "/?sessionExpired=true";
				}, 300000);		} //300000

			document.onload = resetTimer();
			document.onmousemove = resetTimer;
			document.onkeypress = resetTimer;
			document.onclick = resetTimer;
		</script>-->
		
		<script>
				function toggleUserInfo() {
					const box = document.getElementById("userInfoBox");
					box.style.display = (box.style.display === "block") ? "none" : "block";
				}

				document.addEventListener("click", function (event) {
					const box = document.getElementById("userInfoBox");
					const image = document.getElementById("profileImage");

					// If the click is outside the image and box, hide it
					if (!box.contains(event.target) && !image.contains(event.target)) {
						box.style.display = "none";
					}
				});
			</script>
			<script>
			    function toggleUploadLink() {
			        const linkDiv = document.getElementById('uploadLinkContainer');
			        linkDiv.style.display = linkDiv.style.display === 'none' ? 'block' : 'none';
			    }

			    function previewAndSaveProfile() {
			        const input = document.getElementById('profileUpload');
			        const file = input.files[0];
			        if (!file) return;

			        const reader = new FileReader();
			        reader.onload = function (e) {
			            const base64Image = e.target.result;
			            document.getElementById('profileImagePreview').src = base64Image;
			            localStorage.setItem('profileImageBase64', base64Image);
			        };
			        reader.readAsDataURL(file);
			    }

			    // Load image from localStorage on page load
			    window.addEventListener('DOMContentLoaded', () => {
			        const savedImage = localStorage.getItem('profileImageBase64');
			        if (savedImage) {
			            document.getElementById('profileImagePreview').src = savedImage;
			        }
			    });
			</script>
			<script>
			    function toggleUploadDropdown() {
			        const container = document.getElementById('uploadLinkContainer');
			        container.style.display = (container.style.display === 'block') ? 'none' : 'block';
			    }

			    // Optional: Hide dropdown when clicking outside
			    document.addEventListener('click', function (event) {
			        const wrapper = document.getElementById('settingsWrapper');
			        const dropdown = document.getElementById('uploadLinkContainer');
			        if (!wrapper.contains(event.target)) {
			            dropdown.style.display = 'none';
			        }
			    });
			</script>
			
			<script>
			  $(document).ready(function () {
			    // Show the card on click
			    $('#historyBtn').click(function () {
					hideAllCards(); 
			      $('#historyCard').fadeIn();
			    });

			    // Optional: Hide when clicked outside the card
			    $(document).mouseup(function (e) {
			      var card = $("#historyCard");
			      if (!card.is(e.target) && card.has(e.target).length === 0) {
			        card.fadeOut();
			      }
			    });
			  });
			</script>
		
			<script>
			  $(document).ready(function () {
			    $('#rolesBtn').click(function () {
					hideAllCards(); 
			      $('#rolesCard').fadeIn();
			    });

			    $(document).mouseup(function (e) {
			      const card = $("#rolesCard");
			      if (!card.is(e.target) && card.has(e.target).length === 0) {
			        card.fadeOut();
			      }
			    });
			  });
			</script>
		
			
			<script>
			  $(document).ready(function () {
				$('#studentCount').text(0);
				$('#studentsBtn').click(function () {
					hideAllCards(); 
				  const count = $('#student-table tbody tr').length;
				  $('#studentCount').text(count);
				  $('#studentsCard').fadeIn();
				});


			    // Hide card on outside click
			    $(document).mouseup(function (e) {
			      const card = $("#studentsCard");
			      if (!card.is(e.target) && card.has(e.target).length === 0) {
			        card.fadeOut();
			      }
			    });
				
				//////
				$('#unpaidBtn').click(function () {
					hideAllCards(); 
				     let unpaidCount = 0;

				     // Loop through all table rows and find hidden paidFees
				     $('#student-table tbody tr').each(function () {
				       const paid = parseInt($(this).find('td:eq(6)').text().trim()); // td:eq(6) is paidFees
				       if (paid === 1) {
				         unpaidCount++;
				       }
				     });

				     $('#unpaidCount').text(unpaidCount);
				     $('#unpaidCard').fadeIn(); // âœ… This shows the card
				   });

				   // âœ… Hide card if clicked outside
				   $(document).mouseup(function (e) {
				     const card = $("#unpaidCard");
				     if (!card.is(e.target) && card.has(e.target).length === 0) {
				       card.fadeOut();
				     }
				   });
			  });
			</script>

			<!-- JavaScript -->
			<script>
			  const markBtn = document.getElementById('markPlacementBtn');
			  const placementCard = document.getElementById('placementCard');

			  markBtn.onclick = function () {
			    placementCard.style.display = 'block';
			  };

			  function hidePlacementCard() {
			    placementCard.style.display = 'none';
			  }

			  // Optional: Hide when clicking outside the card
			  window.onclick = function(event) {
			    if (event.target === placementCard) {
			      placementCard.style.display = "none";
			    }
			  };
			</script>
			
			
			
			<script>
			  // Auto-hide alert after 3 seconds
			  window.addEventListener('DOMContentLoaded', function () {
			    const alertBox = document.getElementById('customAlert');
			    if (alertBox) {
			      setTimeout(() => {
			        alertBox.style.opacity = '0';
			        setTimeout(() => alertBox.style.display = 'none', 500);
			      }, 3000);
			    }

			    // Button handlers
			    document.getElementById("markPlacementBtn").onclick = () => {
			      document.getElementById("placementCard").style.display = "block";
			    };

			    document.getElementById("placedStudentsBtn").onclick = () => {
			      document.getElementById("placedStudentsCard").style.display = "block";
			    };
			  });

			  function hidePlacementCard() {
			    document.getElementById("placementCard").style.display = "none";
			  }

			  function hidePlacedStudentsCard() {
			    document.getElementById("placedStudentsCard").style.display = "none";
			  }

			  
			</script>
			
			<!--<script>
			  // Auto-hide after 3 seconds
			  window.addEventListener('DOMContentLoaded', () => {
			    const alertBox = document.getElementById('customAlert');
			    if (alertBox) {
			      setTimeout(() => {
			        alertBox.style.opacity = '0';
			        setTimeout(() => alertBox.style.display = 'none', 500);
			      }, 3000);
			    }
			  });

			  function closeCustomAlert() {
			    const alertBox = document.getElementById('customAlert');
			    alertBox.style.opacity = '0';
			    setTimeout(() => alertBox.style.display = 'none', 500);
			  }
			</script>
			-->
			<!--<script>
			  $(document).ready(function () {
			    $(".placement-btn").click(function () {
			      $.ajax({
			        url: "/placed-data",
			        method: "GET",
			        success: function (data) {
			          let rows = "";
			          data.forEach(student => {
			            rows += `
			              <tr>
			                <td>${student.name}</td>
			                <td>${student.batchNo}</td>
			                <td>${student.mobile}</td>
			                <td>${student.course}</td>
			              </tr>`;
			          });

			          $("#placedStudentsTableBody").html(rows);
			          $("#placementStudentsCard").fadeIn();
			        },
			        error: function () {
			          alert("âŒ Failed to load placed students");
			        }
			      });
			    });
			  });
			</script>

-->
<script>
  setTimeout(() => {
    document.querySelectorAll('.alert').forEach(alert => {
      alert.classList.remove('show');
      alert.classList.add('fade');
    });
  }, 3000); // auto hide after 3 seconds
</script>

<script>
$(document).ready(function () {

  /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 1. open card & load data â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  $("#placedStudentsBtn").on("click", function () {
	hideAllCards(); 
    $.ajax({
      url: "/placed-data",
      method: "GET",
      success: function (data) {
        // build rows
        let rows = data.map(s => `
          <tr>
            <td class="name-cell">${s.name}</td>
            <td>${s.batchNo}</td>
            <td>${s.mobile}</td>
            <td>${s.course}</td>
          </tr>`).join("");
        $("#placedStudentsTableBody").html(rows);

        // reset search box
        $("#studentSearch").val("");

        // show card
        $("#placementStudentsCard").fadeIn();
      },
      error: () => alert("âŒÂ Failed to load placed students")
    });
  });

    /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 2. live search filter â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    $("#studentSearch").on("keyup", function () {
      const query = $(this).val().toLowerCase();
      $("#placedStudentsTableBody tr").each(function () {
        const name = $(this).find(".name-cell").text().toLowerCase();
        $(this).toggle(name.indexOf(query) !== -1);
      });
    });

  });
  </script>
  
  <!-- Auto Logout Script -->
  	<script>
  		function resetTimer() {
  			clearTimeout(timer);

  			// Optional: keep session alive on user activity
  			fetch('/keepAlive', { method: 'POST' });

  			timer = setTimeout(() => {
  				fetch('/autoLogout', { method: 'POST' }).then(() => {
  					window.location.href = "/?sessionExpired=true";
  				});
  			}, 300000);
  		}

  	</script>
  	<!-- Auto Logout End -->

	<script>
		$('#fourBtn').click(function () {
		  hideAllCards(); // hide others first

		  let count = 0;
		  const tbody = $('#fourTableBody');
		  if (tbody) tbody.empty();

		  $('#student-table tbody tr').each(function () {
		    const tds = $(this).find('td');

		    const name = $(tds[0]).text().trim();
		    const batch = $(tds[3]).text().trim();
		    const mobile = $(tds[2]).text().trim();
		    const paid = parseFloat($(tds[6]).text().trim()); // hidden td

		    if (paid === 40000.0) {
		      tbody.append(`<tr><td>${name}</td><td>${batch}</td><td>${mobile}</td></tr>`);
		      count++;
		    }
		  });

		  $('#fourCount').text(count);
		  $('#fourCard').fadeIn();
		});

		$('#fourFiveBtn').click(function () {
		  hideAllCards(); // hide others first

		  let count = 0;
		  const tbody = $('#fourFiveTableBody');
		  tbody.empty();

		  $('#student-table tbody tr').each(function () {
		    const tds = $(this).find('td');

		    const name = $(tds[0]).text().trim();
		    const batch = $(tds[3]).text().trim();
		    const mobile = $(tds[2]).text().trim();
		    const paid = parseFloat($(tds[6]).text().trim()); // hidden td

		    if (paid === 45000.0) {
		      tbody.append(`<tr><td>${name}</td><td>${batch}</td><td>${mobile}</td></tr>`);
		      count++;
		    }
		  });

		  $('#fourFiveCount').text(count);
		  $('#fourFiveCard').fadeIn();
		});

	</script>
<script>
	function hideAllCards() {
	  $('#historyCard').fadeOut();
	  $('#rolesCard').fadeOut();
	  $('#studentsCard').fadeOut();
	  $('#fourCard').fadeOut();
	  	  $('#fourFiveCard').fadeOut();
	  	  $('#unpaidCard').fadeOut();
		  $('#placementCard').fadeOut();
		  	  $('#placementStudentsCard').fadeOut();
	
	  
	}

	</script>
	<script>
	$(document).mouseup(function (e) {
	  const cards = ['#historyCard','#rolesCard','#studentsCard', '#fourCard', '#fourFiveCard','#unpaidCard','#placementCard','#placementStudentsCard'];

	  cards.forEach(function (id) {
	    const card = $(id);
	    if (!card.is(e.target) && card.has(e.target).length === 0) {
	      card.fadeOut();
	    }
	  });
	});
	</script>
</body>

</html>